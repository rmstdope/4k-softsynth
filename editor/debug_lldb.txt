# LLDB debugging script for C++ Python extension
# Usage: lldb -p <PID> -s debug_lldb.txt

# Enable verbose symbol loading
settings set symbols.enable-external-lookup true
settings set target.inline-breakpoint-strategy always

# List loaded images to see if our extension is loaded
image list

# Set breakpoints in C++ code
# Note: These breakpoints will only work after the extension is loaded
breakpoint set --file synth_bindings.cpp --line 56 --name SynthEngine::initialize
breakpoint set --file synth_bindings.cpp --line 63 --name SynthEngine::render_note  
breakpoint set --file synth_bindings.cpp --line 80 --name SynthEngine::render_instrument_note

# Set a breakpoint on Python import to catch when extension loads
breakpoint set --name PyInit_synth_engine

# List all breakpoints
breakpoint list

# Continue execution
continue

# Instructions:
# 1. Run the debug_cpp.py script first to get the PID
# 2. Run: lldb -p <PID> -s debug_lldb.txt
# 3. The script will set breakpoints and continue
# 4. In the Python script, press ENTER to trigger C++ functions