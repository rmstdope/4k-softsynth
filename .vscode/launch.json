{
	"version": "0.2.0",
	"configurations": [
		
		{
			"name": "Debug Main Editor",
			"type": "debugpy",
			"request": "launch",
			"module": "editor",
			"console": "integratedTerminal",
			"cwd": "${workspaceFolder}/editor/src",
			"python": "${workspaceFolder}/.venv/bin/python",
			"justMyCode": false,
			"stopOnEntry": false,
			"purpose": ["debug-in-terminal"],
			"args": []
		},

		{
			"name": "Debug Main Editor (Alternative)",
			"type": "debugpy",
			"request": "launch",
			"program": "${workspaceFolder}/editor/src/editor/__main__.py",
			"console": "integratedTerminal",
			"cwd": "${workspaceFolder}/editor/src",
			"python": "${workspaceFolder}/.venv/bin/python",
			"justMyCode": false,
			"stopOnEntry": false,
			"args": []
		},

		{
			"name": "Attach C++ to Process",
			"type": "cppdbg",
			"request": "attach",
			"program": "${workspaceFolder}/.venv/bin/python",
			"processId": "${command:pickProcess}",
			"MIMode": "lldb",
			"sourceFileMap": {
				"${workspaceFolder}/editor/cpp": "${workspaceFolder}/editor/cpp",
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/include": "${workspaceFolder}/softsynth/include"
			},
			"setupCommands": [
				{
					"description": "Enable pretty-printing for gdb",
					"text": "settings set target.inline-breakpoint-strategy always"
				},
				{
					"description": "Load debug symbols for Python extension",
					"text": "image list"
				},
				{
					"description": "Set symbol search paths",
					"text": "settings set target.exec-search-paths ${workspaceFolder}/editor:${workspaceFolder}/softsynth/bin"
				}
			],
			"symbolLoadInfo": {
				"loadAll": true,
				"exceptionList": ""
			}
		},
		{
			"name": "Attach C++ by PID", 
			"type": "cppdbg",
			"request": "attach",
			"program": "${workspaceFolder}/.venv/bin/python",
			"processId": "${input:processPid}",
			"MIMode": "lldb",
			"sourceFileMap": {
				"${workspaceFolder}/editor/cpp": "${workspaceFolder}/editor/cpp",
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/include": "${workspaceFolder}/softsynth/include"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				},
				{
					"description": "Enable verbose symbol loading",
					"text": "settings set symbols.enable-external-lookup true"
				},
				{
					"description": "Load debug symbols and wait for extension",
					"text": "image list"
				},
				{
					"description": "Set symbol search paths",
					"text": "settings set target.exec-search-paths ${workspaceFolder}/editor:${workspaceFolder}/softsynth/bin"
				},
				{
					"description": "Wait for synth_engine module load",
					"text": "breakpoint set --name dlopen --auto-continue true --one-shot true"
				}
			],
			"symbolLoadInfo": {
				"loadAll": true,
				"exceptionList": ""
			}
		},
		{
			"name": "Debug Python Extension (C++)",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/.venv/bin/python",
			"args": ["-c", "import synth_engine; engine = synth_engine.SynthEngine(); engine.initialize(); print('Extension loaded successfully')"],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/editor",
			"environment": [
				{
					"name": "PYTHONPATH",
					"value": "${workspaceFolder}/editor/src"
				}
			],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "build-debug-extension",
			"sourceFileMap": {
				"${workspaceFolder}/editor/cpp": "${workspaceFolder}/editor/cpp",
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/include": "${workspaceFolder}/softsynth/include"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				},
				{
					"description": "Load all debug symbols",
					"text": "image list"
				}
			],
			"symbolLoadInfo": {
				"loadAll": true,
				"exceptionList": ""
			}
		},
		{
			"name": "Debug softsynth",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/softsynth",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "make",
			"sourceFileMap": {
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				}
			]
		},

		{
			"name": "Debug test_softsynth",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_softsynth",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "make",
			"sourceFileMap": {
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/test": "${workspaceFolder}/softsynth/test"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				}
			]
		},
		{
			"name": "Debug test_oscillator",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_oscillator",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "make",
			"sourceFileMap": {
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/test": "${workspaceFolder}/softsynth/test"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				}
			]
		},
		{
			"name": "Debug test_envelope",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_envelope",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "make",
			"sourceFileMap": {
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/test": "${workspaceFolder}/softsynth/test"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				}
			]
		},
		{
			"name": "Debug test_filter",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_filter",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "make",
			"sourceFileMap": {
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/test": "${workspaceFolder}/softsynth/test"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				}
			]
		},
		{
			"name": "Debug test_arithmetic",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_arithmetic",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "make",
			"sourceFileMap": {
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/test": "${workspaceFolder}/softsynth/test"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				}
			]
		},
		{
			"name": "Debug test_accumulate",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_accumulate",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "make",
			"sourceFileMap": {
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/test": "${workspaceFolder}/softsynth/test"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				}
			]
		},
		{
			"name": "Debug test_storeval",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_storeval",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "make",
			"sourceFileMap": {
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/test": "${workspaceFolder}/softsynth/test"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				}
			]
		},
		{
			"name": "Debug test_processing",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_processing",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "make",
			"sourceFileMap": {
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/test": "${workspaceFolder}/softsynth/test"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				}
			]
		},
		{
			"name": "Debug test_output",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_output",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": false,
			"MIMode": "lldb",
			"preLaunchTask": "make",
			"sourceFileMap": {
				"${workspaceFolder}/softsynth/src": "${workspaceFolder}/softsynth/src",
				"${workspaceFolder}/softsynth/test": "${workspaceFolder}/softsynth/test"
			},
			"setupCommands": [
				{
					"description": "Enable assembly debugging",
					"text": "settings set target.inline-breakpoint-strategy always"
				}
			]
		},
		{
			"name": "Run test_softsynth",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_softsynth",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": true,
			"MIMode": "lldb",
			"preLaunchTask": "run_test_softsynth"
		},
		{
			"name": "Run test_oscillator",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_oscillator",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": true,
			"MIMode": "lldb",
			"preLaunchTask": "run_test_oscillator"
		},
		{
			"name": "Run test_envelope",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_envelope",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": true,
			"MIMode": "lldb",
			"preLaunchTask": "run_test_envelope"
		},
		{
			"name": "Run test_filter",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_filter",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": true,
			"MIMode": "lldb",
			"preLaunchTask": "run_test_filter"
		},
		{
			"name": "Run test_arithmetic",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_arithmetic",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": true,
			"MIMode": "lldb",
			"preLaunchTask": "run_test_arithmetic"
		},
		{
			"name": "Run test_accumulate",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_accumulate",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": true,
			"MIMode": "lldb",
			"preLaunchTask": "run_test_accumulate"
		},
		{
			"name": "Run test_storeval",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_storeval",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": true,
			"MIMode": "lldb",
			"preLaunchTask": "run_test_storeval"
		},
		{
			"name": "Run test_processing",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_processing",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": true,
			"MIMode": "lldb",
			"preLaunchTask": "run_test_processing"
		},
		{
			"name": "Run test_output",
			"type": "cppdbg",
			"request": "launch",
			"program": "${workspaceFolder}/softsynth/bin/test_output",
			"args": [],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": true,
			"MIMode": "lldb",
			"preLaunchTask": "run_test_output"
		},
		{
			"name": "Run All Tests",
			"type": "cppdbg",
			"request": "launch",
			"program": "/usr/bin/make",
			"args": ["run_tests"],
			"stopAtEntry": false,
			"cwd": "${workspaceFolder}/softsynth",
			"environment": [],
			"externalConsole": true,
			"MIMode": "lldb",
			"preLaunchTask": "make"
		},
	],
	"inputs": [
		{
			"id": "processPid",
			"description": "Enter the Process ID (PID) to attach to",
			"default": "",
			"type": "promptString"
		}
	]
}
